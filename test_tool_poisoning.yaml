# Minimal Security Guards Test - Tool Poisoning Only
binds:
  - port: 8080
    listeners:
      - routes:
          - backends:
              - mcp:
                  securityGuards:
                    - id: tool-poisoning-detector
                      enabled: true
                      priority: 100
                      failure_mode: fail_closed
                      timeout_ms: 50
                      runs_on:
                        - response
                      type: tool_poisoning
                      strict_mode: true
                      custom_patterns:
                        - "(?i)SYSTEM:\\s*override"
                      scan_fields:
                        - name
                        - description
                      alert_threshold: 1
                  targets:
                    - name: echo-server
                      stdio:
                        cmd: echo
                        args: ["MCP Available"]
